name: Grit & Gold Auto-Uploader
on:
  schedule:
    - cron: '0 */4 * * *' # يعمل كل 4 ساعات تلقائياً
  workflow_dispatch: # يسمح لك بتشغيله يدوياً

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'  # ⬅️ رفع إلى 3.10
      
      - name: Install system dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg
      
      - name: Install Python dependencies
        run: |
          pip install google-genai google-api-python-client google-auth-oauthlib yt-dlp opencv-python-headless pillow moviepy
          # تثبيت whisper إذا كان متوفراً
          pip install openai-whisper || echo "Whisper installation failed, continuing..."
          # تثبيت mediapipe إذا كان متوفراً
          pip install mediapipe || echo "Mediapipe installation failed, continuing..."
      
      - name: Create necessary directories
        run: |
          mkdir -p config_grit_gold output_grit_gold temp_grit_gold logs_grit_gold database_grit_gold
      
      - name: Run Bot (Single Cycle)
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python deepseek_python_20260127_288de0.py <<< "1"
