name: Grit & Gold Auto-Uploader
on:
  schedule:
    - cron: '0 */4 * * *'  # ูุนูู ูู 4 ุณุงุนุงุช ุชููุงุฆูุงู
  workflow_dispatch:  # ูุณูุญ ูู ุจุชุดุบููู ูุฏููุงู

jobs:
  build:
    runs-on: ubuntu-22.04  # โฌ๏ธ ุงุณุชุฎุฏุงู ูุณุฎุฉ ูุณุชูุฑุฉ
    timeout-minutes: 30
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install system dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg
      
      - name: Install Python dependencies
        run: |
          pip install --upgrade pip
          pip install google-genai google-api-python-client google-auth-oauthlib
          pip install yt-dlp moviepy opencv-python-headless pillow
      
      - name: Create config from secrets
        run: |
          mkdir -p config_grit_gold
          
          # ุฅูุดุงุก ููู Gemini key
          if [ -n "$GEMINI_API_KEY" ]; then
            echo "$GEMINI_API_KEY" > config_grit_gold/gemini_key.txt
            echo "โ ุชู ุฅูุดุงุก ููู gemini_key.txt"
          else
            echo "โ๏ธ GEMINI_API_KEY ุบูุฑ ููุฌูุฏ"
          fi
          
          # ุฅูุดุงุก ููู youtube credentials
          if [ -n "$YOUTUBE_CREDENTIALS" ]; then
            echo "$YOUTUBE_CREDENTIALS" > config_grit_gold/youtube_credentials.json
            echo "โ ุชู ุฅูุดุงุก ููู youtube_credentials.json"
          else
            echo "โ๏ธ YOUTUBE_CREDENTIALS ุบูุฑ ููุฌูุฏ"
          fi
          
          # ุฅูุดุงุก ุจุงูู ุงููุฌูุฏุงุช
          mkdir -p output_grit_gold temp_grit_gold logs_grit_gold database_grit_gold
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          YOUTUBE_CREDENTIALS: ${{ secrets.YOUTUBE_CREDENTIALS }}
      
      - name: Run Bot
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          YOUTUBE_CREDENTIALS: ${{ secrets.YOUTUBE_CREDENTIALS }}
        run: |
          echo "๐ ุจุฏุก ุชุดุบูู ุงูุจูุช..."
          python deepseek_python_20260127_288de0.py --auto
